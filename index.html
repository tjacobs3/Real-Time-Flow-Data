<!doctype html>

<html>
  <head>
    <style type="text/css" media="screen">
      html, body {
        margin: 0;
      }
      
      body {
        background: #eee;
      }
      
      #container {
        background: white;
        border: 1px solid #ccc;
        font-family: "Helvetica Neue", Arial, sans-serif;
        margin: 1em auto;
        min-height: 500px;
        padding: 0 1em;
        position: relative;
        width: 950px;
      }
      
      #container .chart_prompt {
        left: 0;
        margin: auto;
        position: absolute;
        right: 0;
        top: 20px;
        width: 300px;
      }
      
      #header {
        border-bottom: 1px solid #999;
      }
      
      .prompt {
        font-style: italic;
        margin: 1em auto;
        padding: 1em;
        text-align: center;
        width: 300px;
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/highcharts.js" type="text/javascript"></script>
	<link href="http://www.usgs.gov/styles/common.css" rel="stylesheet" type="text/css">
  </head>
  <body>
  
  <!-- BEGIN USGS Header Template -->

<div id="usgscolorband">

	<div id="usgsbanner">

		<div id="usgsidentifier"><a href="http://www.usgs.gov/"><img src="http://www.usgs.gov/images/header_graphic_usgsIdentifier_white.jpg" alt="USGS - science for a changing world" title="U.S. Geological Survey Home Page" width="178" height="72" /></a></div>

		<div id="usgsccsabox">

			<div id="usgsccsa">

			  <br /><a href="http://www.usgs.gov/">USGS Home</a>

			  <br /><a href="http://www.usgs.gov/ask/">Contact USGS</a>

			  <br /><a href="http://search.usgs.gov/">Search USGS</a>

			</div>

		</div>

	</div>

</div>

<div id="usgstitle">

	<p>Illinois Water Science Center</p>

</div>

<!-- END USGS Header Template -->
  
  
  
    <div id="container">
      <div id="header">
        <h1>Real-time Stream Flow Data</h1>
      </div>
      <div id="content">
        <div id="filter">
          <form>
            <div id="location-time-type">
              <span>
                Location:
                <select name="location" id="location">
                  <option value="U22">U22</option>
				  <option value="U84">U84</option>
                  <option value="D57">D57</option>
				  <option value="D108">D108</option>
                </select>
              </span>
              <span>
                <label for="period">Period</label><input type="text" name="period" value="7" id="period">
              </span>
              <!-- <span id="data-type">
Data Type:
<input type="radio" name="data-type" value="real" id="data-type-observed"><label for="data-type-real">Observed Data</label>
<input type="radio" name="data-type" value="simulated" id="data-type-simulated"><label for="data-type-simulated">Simulated Data</label>
<input type="radio" name="data-type" value="both" id="data-type-real" checked="checked"><label for="data-type-both">Both</label>
</span> -->
              <span>
                <a id="refresh-button">Refresh</a>
              </span>
            </div>
          </form>
        </div>
        <div id="main-content">
          <div id="elevation"></div>
          <hr />
          <div id="discharge"></div>
        </div>
      </div>
      <div id="footer">
      </div>
    </div>
    
    <script type="text/javascript" charset="utf-8">
      var rsfd = rsfd || {};
      rsfd.ui = rsfd.ui || {};
      rsfd.data = rsfd.data || {};
      rsfd.chart = rsfd.chart || {};
      rsfd.controller = rsfd.controller || {};
      
      rsfd.ui.showLoading = function () {
        $('#main-content>div').hide();
        $('#main-content #loading').show();
      }
      
      rsfd.ui.showSelectPrompt = function () {
        $('#main-content>div').hide();
        $('#main-content #select-prompt').show();
      }
      
      rsfd.ui.getLocation = function () {
        return $("#location option:selected").val()
      }
      
      rsfd.ui.getPeriod = function () {
        return parseInt($("#period").val());
      }
      
      rsfd.ui.getDataType = function () {
        return "both";
        return $("#data-type input[name='data-type']:checked").val();
      }
      
      rsfd.ui.getAllParameter = function () {
        return {
          location: rsfd.ui.getLocation(),
          period: rsfd.ui.getPeriod(),
          data_type: rsfd.ui.getDataType()
        }
      }
      
      rsfd.data.getRealData = function (p, callbackFunc) {
        if (typeof callbackFunc !== 'function')
          return false;
         
        $.getJSON('get_plot_data.php', p, callbackFunc);
        
        return true;
      };
      
      rsfd.data.getSimulatedData = function (p, simfile, callbackFunc) {
        if (typeof callbackFunc !== 'function')
          return false;
          
        p2 = {};
        
        for (var prop in p) {
          p2[prop] = p[prop];
        }
        
        if (typeof simfile === "string" && simfile !== '')
          p2.simLocation = simfile;
          
        $.getJSON('get_simulation_data.php', p2, callbackFunc);
        
        return true;
      }
      
      rsfd.chart.Chart = function (container, title, location, id) {
        if (typeof id !== 'string') {
          id = container + '_chart';
        }
        
        this.container = container;
        this.title = title;
        this.location = location;
        this.id = id;
        this.loading = 0;
        
        this.chart = new Highcharts.Chart({
          chart: {
zoomType: 'x',
            renderTo: container
          },
          title: {
            text: this.title
          },
          location: {
            text: this.location
          },
     plotOptions: {
       series: {
       marker: {
       enabled: false,
       states: {
       hover: {
       enabled: true
       }
       }
       }
       }
     },
          tooltip: {
            formatter: function () {
              return Highcharts.dateFormat("%b %d, %Y", this.x) + ": " + this.y;
            }
          },
          xAxis: {
            type: 'datetime',
            dateTimeLabelFormats: {

            }
          },
          series: []
        });
        
        this.series = {};
        
        var con = $('#' + this.container);
        var prompt =
          $('<div></div>')
            .attr('id', id + '_prompt')
            .addClass('chart_prompt')
            .hide()
            .appendTo(con);
      }
      
      rsfd.chart.Chart.prototype.displayData = function (data) {
        for (var type in data.series) {
          if (type in this.series) {
            this.series[type].remove();
          }
          
          this.series[type] = this.chart.addSeries({
            type: 'spline',
            name: type,
            data: data.series[type],
            pointStart: Date(0)
          });
          
        }
      }
      
      
      rsfd.chart.Chart.prototype.showPrompt = function (id, content) {
        
      }
      
      rsfd.chart.Chart.prototype.hidePrompt = function (id, content) {
        
      }
      
      rsfd.controller.Controller = function () {
        this.charts = {};
      }
      
      rsfd.controller.Controller.prototype.registerChart = function (type, chart) {
        this.charts[type] = chart;
      }
	  
	  rsfd.controller.Controller.prototype.shiftValues = function (chartName, seriesName, amount) {
		//alert(this.charts);
		for (var chart_type in this.charts)
		{
			//alert(chart_type);
			if(chart_type == chartName) {
				for (var seriesPlot in this.charts[chart_type].series)
				{
					//alert(seriesPlot);
					if(seriesPlot == seriesName) {
						for (var point in this.charts[chart_type].series[seriesPlot].data)
						{
							//alert(this.charts[chart_type].series[seriesPlot].data[point].y);
							this.charts[chart_type].series[seriesPlot].data[point].update(this.charts[chart_type].series[seriesPlot].data[point].y += amount, false, false);
						}
					}
				}
				this.charts[chart_type].redraw();
			}
		}
	  }
      
      rsfd.controller.Controller.prototype.showData = function() {
        var p = rsfd.ui.getAllParameter();
        
        for (var chart_type in this.charts) {
          var chart = this.charts[chart_type];
          p.chartType = chart_type;
          rsfd.data.getRealData(p, function (c) {
            return function (data) {
              c.displayData(data);
            }
          } (chart));
          
          rsfd.data.getSimulatedData(p, '', function (c) {
            return function (data) {
              c.displayData(data);
            }
          } (chart));

          rsfd.data.getSimulatedData(p, 'ld2g1.2011.wsq', function (c) {
            return function (data) {
              c.displayData(data);
            }
          } (chart));
        }
      }
      
      $(document).ready(function () {
        //rsfd.ui.showSelectPrompt();
        var elevation_chart = new rsfd.chart.Chart("elevation", rsfd.ui.getLocation() + " Gage Height", rsfd.ui.getLocation());
        var discharge_chart = new rsfd.chart.Chart("discharge", rsfd.ui.getLocation() + " Discharge", rsfd.ui.getLocation());
        controller = new rsfd.controller.Controller();
        controller.registerChart("elevation", elevation_chart);
        controller.registerChart("discharge", discharge_chart);
        controller.showData();
        $('#refresh-button').click(function () {
          controller.showData();
        });
		setTimeout("controller.shiftValues('elevation', 'Simulated Data: ld2g1.2011.wsq', -600)",4000);
      })
    </script>
	
			<!-- BEGIN USGS Footer Template --> 
	<p id="linksfooterbar"> 
	<a href="http://www.usgs.gov/" title="USGS Home page.">USGS Home</a> 
	<a href="http://water.usgs.gov/" title="USGS Water Resources of the United States">Water Resources</a> 
	<a href="http://biology.usgs.gov/" title="USGS Biological Resources Discipline">Biology</a> 
	<a href="http://geography.usgs.gov/" title="USGS Geography">Geography</a> 
	<a href="http://geology.usgs.gov/" title="USGS Geology Discipline">Geology</a> 
	<a href="http://www.usgs.gov/ngpo/" title="USGS National Geospatial Program Office">Geospatial</a> 
	</p> 
 
 
	<div id="usgsfooter"> 
	<p id="usgsfooterbar"> 
		<a href="http://www.usgs.gov/laws/accessibility.html" title="Accessibility Policy (Section 508)">Accessibility</a> 
		<a href="http://www.usgs.gov/foia/" title="Freedom of Information Act">FOIA</a> 
		<a href="http://www.usgs.gov/laws/privacy.html" title="Privacy policies of the U.S. Geological Survey.">Privacy</a> 
		<a href="http://www.usgs.gov/laws/policies_notices.html" title="Policies and notices that govern information posted on USGS Web sites.">Policies and Notices</a> 
	</p> 
 
		<p id="usgsfootertext"> 
			<a href="http://www.takepride.gov/"><img src="http://www.usgs.gov/images/footer_graphic_takePride.jpg" alt="Take Pride in America logo" title="Take Pride in America Home Page" width="60" height="58"></a> 
		<a href="http://firstgov.gov/"><img src="http://www.usgs.gov/images/footer_graphic_usagov.jpg" alt="USA.gov logo" width="90" height="26" style="float: right; margin-right: 10px;" title="USAGov: Government Made Easy."></a> 
			<a href="http://www.doi.gov/">U.S. Department of the Interior</a> |
			<a href="http://www.usgs.gov/">U.S. Geological Survey</a><br> 
	URL: http://il.water.usgs.gov/index.html<br> 
	Page Contact Information: <a href="mailto:gs-w-ilurb_webmaster@usgs.gov">GS-W-ILurb_Webmaster@usgs.gov</a><br> 
	Page Last Modified: Friday, 14-Jan-2011 13:47:01 CST
		</p> 
	</div> 
	<!-- END USGS Footer Template --> 
	
  </body>
</html>